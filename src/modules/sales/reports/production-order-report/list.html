<template>
    <style>
        table > tbody > tr > td {
            white-space:pre;
        }
    </style>
<h1 class="page-header">Laporan Monitoring Surat Perintah Produksi</h1>
<form class="form-horizontal">
    <textbox                    label="Nomor Sales Contract"    value.bind="salesContractNo"	></textbox>
        <textbox                    label="Nomor Order Produksi"    value.bind="orderNo"            ></textbox>
        <order-type-auto-suggest	label="Jenis Order"	            value.bind="orderType" 	        change.delegate="orderTypeChanged($event)"></order-type-auto-suggest>
        <process-type-auto-suggest	label="Jenis Proses"	        value.bind="processType" 	    change.delegate="processTypeChanged($event)" filter.bind="filterOrder" if.bind="orderType" ></process-type-auto-suggest>
        <buyer-auto-suggest	        label="Buyer"	                value.bind="buyer" 	            change.delegate="buyerChanged($event)"></buyer-auto-suggest>
        <account-auto-suggest	    label="Staff Penjualan"	        value.bind="account" 	        change.delegate="accountChanged($event)"    filter.bind="filterAccount"></account-auto-suggest>
        <datepicker                 label="Tanggal Awal"            value.bind="dateFrom"           ></datepicker>
        <datepicker                 label="Tanggal Akhir"           value.bind="dateTo"             ></datepicker> 
        
        <div class="form-group">
            <label for="contact" class="col-sm-6 control-label"></label>
            <div class="col-sm-3">
               <button click.delegate="searching()" class='btn btn-success'>Cari</button> 
               <button click.delegate="reset()" class='btn btn-success'>Reset</button>
            </div>
        </div>
        <div>
            <a click.delegate="ExportToExcel()" class='btn btn-primary'>Cetak Excel</a>
        </div>
    <div class="table-responsive">
        <table class="table table-bordered table-hover" border="1" id="myTable">
            <thead align="center">
                <tr>
                    <td rowspan="2">No</td>
                    <td rowspan="2">Nomor Sales Kontrak</td>
                    <td colspan="2">Nomor Order Produksi</td>
                    <td rowspan="2">Jenis Order</td>
                    <td rowspan="2">Jenis Proses</td>
                    <td rowspan="2">Buyer</td>
                    <td rowspan="2">Tipe Buyer</td>
                    <td rowspan="2">Jumlah Order</td>
                    <td rowspan="2">Satuan</td>
                    <td colspan="5">Detail Order</td>
                    <td rowspan="2">Tanggal Delivery</td>
                    <td rowspan="2">Staff Penjualan</td>
                    <td rowspan="2">Status</td>
                    <td rowspan="2">Detail</td>
                </tr>
                <tr>
                    <td>Tgl</td>
                    <td>Nomor</td>
                    <td>Acuan Warna / Desain</td>
                    <td>Warna Yang Diminta</td>
                    <td>Jenis Warna</td>
                    <td>Jumlah</td>
                    <td>Satuan</td>
                </tr>
            </thead>
            <tbody>
                <tr repeat.for="item of data">
                    <td class="text-center">${$index + 1}</td>
                    <td class="text-left">${item.salesContractNo}</td>
                    <td class="text-left">${item._createdDate}</td>
                    <td class="text-left">${item.orderNo}</td>
                    <td class="text-left">${item.orderType}</td>
                    <td class="text-left">${item.processType}</td>
                    <td class="text-left">${item.buyer}</td>
                    <td class="text-left">${item.buyerType}</td>
                    <td class="text-right">${item.orderQuantity}</td>
                    <td class="text-left">${item.uom}</td>
                    <td class="text-left">${item.colorTemplate}</td>
                    <td class="text-left">${item.colorRequest}</td>
                    <td class="text-left">${item.colorType}</td>
                    <td class="text-right">${item.quantity}</td>
                    <td class="text-left">${item.uomDetail}</td>
                    <td class="text-left">${item.deliveryDate}</td>
                    <td class="text-left">${item.firstname} ${item.lastname}</td>
                    <td class="text-left">${item.status}</td>
                    <td class="text-left">${item.detail}</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="alert alert-info text-center" role="alert" if.bind="data.length == 0">
        Tidak ada data ditemukan.
    </div>
    <hr/>
</form>
</template>

